var jmApp=angular.module("jordan_muir_app",["ngAnimate","ui.router"]);function gup(name,url){url||(url=location.href),name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var results=new RegExp("[\\?&]"+name+"=([^&#]*)").exec(url);return null==results?null:results[1]}jmApp.run(["$rootScope",function($rootScope){$rootScope.template_directory=template_directory,$rootScope.aboutModal={visible:!1,openModal:function(){$rootScope.aboutModal.visible=!0},closeModal:function(){$rootScope.aboutModal.visible=!1}},$rootScope.contactModal={visible:!1,openModal:function(){$rootScope.contactModal.visible=!0},closeModal:function(){$rootScope.contactModal.visible=!1}},$rootScope.keypress=function(event){27===event.keyCode&&($rootScope.aboutModal.closeModal(),$rootScope.contactModal.closeModal())},$rootScope.$on("$stateChangeStart",function(){setTimeout(function(){window.scrollTo(0,0)},700)}),$rootScope.clearHeaderTrim=function(){$rootScope.projectTitleColour=null,$rootScope.projectTitleWidth=0},"true"==gup("view")&&($(".coming-soon-overlay").addClass("hidden"),$("body").removeClass("hide-overflow"))}]),jmApp.config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/"),$stateProvider.state("project-listing",{url:"/",controller:"projectListingController",templateUrl:template_directory+"/angular/views/project-listing.html",resolve:{projects:function(wp){return wp.getProjects()}},onExit:function($rootScope){$rootScope.headerTrimWidth="0px"}}).state("project",{url:"/project/:project_slug/",templateUrl:template_directory+"/angular/views/project.html",controller:"projectController",resolve:{project:function(wp,$stateParams){return wp.getProjectWithSlug($stateParams.project_slug)}},onExit:function($rootScope){$rootScope.projectTitleWidth=0}})}]),jmApp.filter("trustAsResourceUrl",["$sce",function($sce){return function(val){return $sce.trustAsResourceUrl(val)}}]),jmApp.filter("extractSurroundingTags",function(){return function(input,tag){var result="";if("string"==typeof input){var leadingSearchString="<"+tag+">",closingSearchString="</"+tag+">";result=(result=(input=input||"").replace(leadingSearchString,"")).replace(closingSearchString,"")}else console.error("extractSurroundingTags: input is not a string:");return result}}),jmApp.filter("trustAsHtml",function($sce){return function(input){return $sce.trustAsHtml(input)}}),jmApp.factory("wp",function($http){return{getProjects:function(){return $http.get("wp-json/katinaAPI/projects/").then(function(response){return response.data},function(){console.error("wp: Error retrieving projects.")})},getProjectWithSlug:function(project_slug){return $http.get("wp-json/katinaAPI/project/"+project_slug).then(function(response){return response.data},function(){console.error("wp: Error retrieving project with name "+project_slug+".")})},postContactForm:function(data){return console.log("Posting following contact data"),console.log(data),$http.post("wp-json/katinaAPI/contact/",data).then(function(response){console.log(response)},function(response){console.error(response)})},getAboutPage:function(){var aboutPageId=0<window.location.hostname.indexOf(".dev")?9:323;return $http.get("wp-json/pages/"+aboutPageId).then(function(response){return response.data},function(){console.error("wp: Error retrieving About Page content.")})}}}),jmApp.controller("errorController",function($scope,$routeParams,$log,wp){console.log($routeParams)}),jmApp.controller("projectController",["$scope","$rootScope","project",function($scope,$rootScope,project){$rootScope.page_title="Jordan Muir - "+project.title,$scope.project=project,$scope.showProjectInformation=!0,$scope.informationHeight=$("#project-page-title-container").height()+7,$scope.project_highlight="text-highlight-"+Math.floor(6*Math.random()+1);var previousScrollTop,projectInformationScrollTop,projectInformationHeight,viewWidth=Math.max(document.documentElement.clientWidth,window.innerWidth||0);$scope.desktopAnimations=1e3<viewWidth,setTimeout(function(){$rootScope.projectTitleColour=$scope.project_highlight,$scope.desktopAnimations?($rootScope.projectTitleWidth=($("#project-page-title").width()||0)+"px",$scope.projectDescriptionHeight=$("#project-page-description").height()):$rootScope.projectTitleWidth="100%",$rootScope.$digest()},1400),$scope.toggleProjectInformation=function(){$scope.showProjectInformation=!$scope.showProjectInformation},$scope.desktopAnimations&&$(window).scroll(_.throttle((previousScrollTop=0,projectInformationScrollTop=$("#project-page-information-container").scrollTop()+16,projectInformationHeight=$("#project-page-information-container").height(),function(){var thisScrollTop=$(this).scrollTop();projectInformationHeight+projectInformationScrollTop<=thisScrollTop&&previousScrollTop<thisScrollTop&&$scope.showProjectInformation?($scope.showProjectInformation=!1,$scope.$digest()):thisScrollTop<previousScrollTop&&!$scope.showProjectInformation&&($scope.showProjectInformation=!0,$scope.$digest()),previousScrollTop=thisScrollTop}),50))}]),jmApp.controller("projectListingController",["$scope","$rootScope","wp","projects",function($scope,$rootScope,wp,projects){$rootScope.page_title="Jordan Muir",$scope.projects=projects,setTimeout($rootScope.clearHeaderTrim(),300),window.setTimeout(function(){$rootScope.headerTrimWidth="100%",$rootScope.$digest()},800)}]),jmApp.directive("aboutModal",function(){return{restrict:"E",scope:!1,templateUrl:template_directory+"/angular/directives/about-modal/about-modal.html",controller:function($scope,$rootScope,wp){wp.getAboutPage().then(function(response){$scope.aboutModal.content=response.content},function(response){console.error("Error retrieving about page.")})}}}),jmApp.directive("contactForm",function(){return{restrict:"E",scope:{},templateUrl:template_directory+"/angular/directives/contact-form/contact-form.html",controller:"contactFormController"}}),jmApp.controller("contactFormController",["$scope","wp",function($scope,wp){$scope.contactFormData={name:"",email:"",subject:"",message:""},$scope.submitContactForm=function(valid){valid&&wp.postContactForm($scope.contactFormData)}}]),jmApp.directive("jmHeader",function(){return{restrict:"E",scope:!0,templateUrl:template_directory+"/angular/directives/header/header.html",controller:function($scope,$rootScope,$state){$scope.template_dir=$rootScope.template_directory}}}),jmApp.directive("projectListingItem",function(){return{restrict:"E",scope:{project:"=project"},templateUrl:template_directory+"/angular/directives/project-listing-item/project-listing-item.html"}}),angular.module("templates-dist",["../angular/views/404.html","../angular/views/project-listing.html","../angular/views/project.html","../angular/directives/about-modal/about-modal.html","../angular/directives/contact-form/contact-form.html","../angular/directives/header/header.html","../angular/directives/project-listing-item/project-listing-item.html"]),angular.module("../angular/views/404.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("../angular/views/404.html","<h1>Page not found.</h1>")}]),angular.module("../angular/views/project-listing.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("../angular/views/project-listing.html",'<div id="project-listing-margin">\n    <div id="project-listing-container" class="listing-grid" >\n\n        <span class="project-listing-item-container"\n              ng-repeat="project in projects">\n            <project-listing-item\n                    class="grid-item"\n                    project="project"\n                    ng-if="project.thumbnail_img"\n                    >\n            </project-listing-item>\n        </span>\n    </div>\n\n</div>')}]),angular.module("../angular/views/project.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("../angular/views/project.html",'<div id="project-page-container">\n\n    <div id="project-page-information-container" class="zoom--custom">\n\n        <div id="project-page-information-center" >\n            <a class="prev-project-container project-changer" ng-show="project.previous_post" href="{{project.previous_post}}" >\n                <i class="fa fa-angle-left fa-3x"></i>\n            </a>\n\n            \x3c!--<div id="project-page-information-content" style="min-height: {{informationHeight}}px">--\x3e\n            <div id="project-page-information-content" ng-class="{\'hide\': !showProjectInformation}" >\n                <div id="project-page-title-container" ng-click="toggleProjectInformation()">\n                    <h1 id="project-page-title" class="{{project_highlight}}">{{project.title}}</h1>\n                </div>\n\n                <div id="project-page-description"\n                     style="max-height: {{(projectDescriptionHeight || 300) + 14}}px;"\n                     ng-bind-html="project.description | trustAsHtml"></div>\n\n                <div class="see-more-information" ng-click="toggleProjectInformation()" ng-if="!showProjectInformation">\n                    <span class="fa fa-circle {{project_highlight}}" ></span>\n                    <span class="fa fa-circle {{project_highlight}}" ></span>\n                    <span class="fa fa-circle {{project_highlight}}" ></span>\n                </div>\n\n                <span id="title-colour-trim" class="{{projectTitleColour}}"\n                      ng-style="{\'width\': projectTitleWidth }"></span>\n            </div>\n\n            <a class="next-project-container project-changer" ng-show="project.next_post" href="{{project.next_post}}" >\n                <i class="fa fa-angle-right fa-3x"></i>\n            </a>\n        </div>\n    </div>\n\n    <div id="project-page-media">\n        <div class="project-page-image-content-container project-image-col-width-{{project_media.column_width}}"\n             ng-repeat="project_media in project.attachments | orderBy: \'order\'">\n\n            <div class="project-video-container project-youtube-video" ng-if="project_media.type == \'video\' && (project_media.src.indexOf(\'.youtube.\') > -1)">\n                <iframe type="text/html" frameborder="0"\n                        ng-src="{{project_media.src + \'?origin=www.jordanmuir.co.uk&controls=2&showinfo=0&rel=0&iv_load_policy=3&fs=1\' | trustAsResourceUrl}}"></iframe>\n            </div>\n\n            <div class="project-video-container project-vimeo-video" ng-if="project_media.type == \'video\' && (project_media.src.indexOf(\'.vimeo.\') > -1)">\n                <iframe ng-src="{{project_media.src + \'?badge=0&byline=0&portrait=0&title=0\' | trustAsResourceUrl}}"\n                        frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>\n            </div>\n\n            <div class="project-page-image-container" ng-if="project_media.type == \'image\'">\n                <img src="{{project_media.img}}" data-action="zoom"/>\n                <p ng-bind="project_media.caption" ng-if="project_media.type == \'image\'"></p>\n            </div>\n        </div>\n\n    </div>\n    <div id="mobile-project-changer">\n        <a id="mobile-prev-project" ng-show="project.previous_post" href="{{project.previous_post}}" >Previous Project</a>\n        <a id="mobile-next-project" ng-show="project.next_post" href="{{project.next_post}}" >Next Project</a>\n    </div>\n</div>')}]),angular.module("../angular/directives/about-modal/about-modal.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("../angular/directives/about-modal/about-modal.html",'<div id="about-modal" class="modal modal-transition"\n     ng-show="aboutModal.visible">\n\n    <span class="modal-close"\n          ng-click="aboutModal.closeModal()">\n        <i class="fa fa-times fa-4x"></i>\n    </span>\n\n    \x3c!-- <button id="about-modal-close-button" class="fadeInOut"\n            ng-click="aboutModal.closeModal()">\n        Close\n    </button> --\x3e\n\n    <div id="about-modal-container">\n        <h1>About</h1>\n        <div id="about-left-panel">\n            <p id="about-page-content" ng-bind-html="aboutModal.content | trustAsHtml"></p>\n            <div id="about-media-links">\n                <a href="mailto:hello@jordanmuir.co.uk">\n                    <img class="media-icon" src="{{template_directory}}/img/media-icons/Email.svg" />\n                </a>\n                <a href="https://www.linkedin.com/pub/jordan-muir/75/447/896" target="_blank">\n                    <img class="media-icon" src="{{template_directory}}/img/media-icons/linkin.svg" />\n                </a>\n                <a href="{{template_directory}}/share/Jordan Muir CV.pdf" download>\n                    <img class="media-icon-less-padding" src="{{template_directory}}/img/media-icons/CV.svg" />\n                </a>\n                \x3c!--<a href="{{template_directory}}/share/Jordan Muir Portfolio.pdf" download>--\x3e\n                    \x3c!--<img class="media-icon-less-padding" src="{{template_directory}}/img/media-icons/Folio.svg" />--\x3e\n                \x3c!--</a>--\x3e\n            </div>\n        </div>\n\n        <div id="about-photo-container">\n        </div>\n    </div>\n\n\n</div>')}]),angular.module("../angular/directives/contact-form/contact-form.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("../angular/directives/contact-form/contact-form.html",'<form id="contact-form" name="contactForm"\n      ng-submit="submitContactForm(contactForm.$valid)" novalidate>\n\n    <div class="form-input-container">\n        <label class="form-label" for="form-name">Your Name</label>\n        <input id="form-name" name="form-name" type="text"\n               ng-class="{\'form-input-highlight\': contactFormData.name != \'\'}"\n               ng-model="contactFormData.name" />\n\n        <p class="form-error"></p>\n    </div>\n\n    <div class="form-input-container">\n        <label class="form-label" for="form-email">Your Email</label>\n        <input id="form-email" name="form-email" type="email"\n               ng-class="{\'form-input-highlight\': contactFormData.email != \'\'}"\n               ng-model="contactFormData.email"/>\n\n        <p class="form-error"></p>\n    </div>\n\n    <div class="form-input-container">\n        <label class="form-label" for="form-subject">Subject</label>\n        <input id="form-subject" name="form-subject" type="text"\n               ng-class="{\'form-input-highlight\': contactFormData.subject != \'\'}"\n               ng-model="contactFormData.subject"/>\n\n        <p class="form-error"></p>\n    </div>\n\n    <div class="form-input-container">\n        <label class="form-label form-label-message" for="form-message">Message</label>\n        <textarea id="form-message" name="form-message"\n                  ng-class="{\'form-textarea-highlight\': contactFormData.message != \'\'}"\n                  ng-model="contactFormData.message"></textarea>\n\n        <p class="form-error"></p>\n    </div>\n\n    <button type="submit" class="contact-form-button" ng-class="{\'form-button-valid\': (contactForm.$valid == true)}">\n        Send\n    </button>\n\n</form>')}]),angular.module("../angular/directives/header/header.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("../angular/directives/header/header.html",'<header id="header" class="zoom--custom">\n    <div id="header-content">\n        {{isHomePage}}\n        <div id="title-container">\n            <a ui-sref="project-listing">\n                <h2>Jordan Muir</h2>\n            </a>\n        </div>\n        <div id="subtitle-container">\n            <h2>3D / Spatial Designer</h2>\n        </div>\n\n        <div id="about-contact-container" >\n            <h2 id="about-link" ng-click="aboutModal.openModal()">About</h2>\n        </div>\n\n        <span id="header-colour-trim" ng-style="{\'width\': headerTrimWidth }"></span>\n    </div>\n</header>')}]),angular.module("../angular/directives/project-listing-item/project-listing-item.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("../angular/directives/project-listing-item/project-listing-item.html",'<a href="{{project.url}}">\n    <img class="grid-img listing-item-text-container"\n         ng-if="project.thumbnail_img"\n         src="{{project.thumbnail_img}}"\n     />\n</a>')}]);